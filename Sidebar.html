<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <style>
      .branding-below {
        bottom: 56px;
        top: 0;
      }
      .branding-text {
        left: 7px;
        position: relative;
        top: 3px;
      }
      .col-contain {
        overflow: hidden;
      }
      .col-one {
        float: left;
        width: 50%;
      }
      .logo {
        vertical-align: middle;
      }
      .radio-spacer {
        height: 20px;
      }
      .width-100 {
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div class="sidebar branding-below">
      <form>
        <div class="block col-contain">
          <div class="col-one">
            <b>Transliterate</b>
          </div>
        </div>
        
        <div class="block form-group">
          <input type="radio" name="scope" id="radio-selection" value="selection" checked="checked">
          <label for="radio-selection">Selected text</label>
          <br>
          <input type="radio" name="scope" id="radio-document" value="document">
          <label for="radio-document">Whole document</label>
        </div>

        <div class="block">
          <button class="blue" id="btn-cyr2lat">Cyrillic -> Latin</button>
          <button id="btn-lat2cyr">Latin -> Cyrillic</button>
        </div>

        <div id="error" class="error"></div>
        <div id="status" class="gray"></div>
      </form>
    </div>

    <div class="sidebar bottom">
      <span class="gray branding-text">Crimean Tatar Transliterator</span>
    </div>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>
      $(function() {
        $('#btn-cyr2lat').click(function() {
            runTransliteration('cyr2lat');
            return false; // Prevent form submission
        });
        
        $('#btn-lat2cyr').click(function() {
            runTransliteration('lat2cyr');
            return false; // Prevent form submission
        });
      });

      function runTransliteration(mode) {
        this.disabled = true;
        $('#error').remove();
        $('#status').text('Transliterating...');
        
        var selectionOnly = $('#radio-selection').is(':checked');
        
        google.script.run
            .withSuccessHandler(
              function(result, element) {
                $('#status').text(result.message);
                element.disabled = false;
              })
            .withFailureHandler(
              function(msg, element) {
                showError(msg, $('#button-bar'));
                element.disabled = false;
                $('#status').text('');
              })
            .withUserObject(this)
            .processTransliteration(mode, selectionOnly);
      }

      function showError(msg, element) {
        var div = $('<div id="error" class="error">' + msg + '</div>');
        $(element).after(div);
      }
    </script>
  </body>
</html>
